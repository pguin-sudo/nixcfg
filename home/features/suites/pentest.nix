{
  config,
  lib,
  pkgs,
  ...
}:
with lib; let
  cfg = config.features.suites.pentest;
in {
  options.features.suites.pentest.enable = mkEnableOption "pentest suite";

  config = mkIf cfg.enable {
    home.packages = with pkgs; [
      # === RECONNAISSANCE ===
      nmap # Network and port scanning
      masscan # Fast large-scale network scanning
      amass # Subdomain enumeration and discovery
      theharvester # Email and information gathering

      # === WEB APPLICATION TESTING ===
      ffuf # Fast web fuzzing and directory discovery
      gobuster # Directory/file and DNS busting tool
      nikto # Web server vulnerability scanner
      sqlmap # Automated SQL injection tool
      wpscan # WordPress security scanner

      # === NETWORK ATTACKS ===
      metasploit # Penetration testing framework
      burpsuite # Web vulnerability testing proxy
      wireshark # Network protocol analyzer
      aircrack-ng # WiFi security auditing tools
      hashcat # Advanced password recovery (GPU optimized)
      john # Password cracking utility

      # === EXPLOITATION ===
      exploitdb # Official exploit database

      # === POST-EXPLOITATION ===
      bloodhound # Active Directory relationship analyzer
      netexec # Windows network exploitation tool
      responder # LLMNR/NBT-NS/mDNS poisoner

      # === FORENSICS & ANALYSIS ===
      binwalk # Firmware analysis and extraction tool
      radare2 # Reverse engineering framework
      ghidra # NSA's software reverse engineering suite
      volatility3 # Memory forensics framework
      hexedit

      # === OSINT ===
      sherlock # Hunt down social media accounts by username

      # === PASSWORD ATTACKS ===
      hydra # Parallelized login cracker

      # === WIRELESS ===
      kismet # Wireless network detector and sniffer
      wifite2 # Automated wireless attack tool
      bully

      # === UTILITIES ===
      netcat # Networking utility for reading/writing network connections
      proxychains-ng # Proxy chains for any network application

      # === STEGANOGRAPHY ===
      exiftool # Read and edit file metadata
    ];
  };
}
